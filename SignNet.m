function [y1] = SignNet(x1)
%SIGNNET neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 10-Jan-2018 16:00:17.
% 
% [y1] = SignNet(x1) takes these arguments:
%   x = 16xQ matrix, input #1
% and returns:
%   y = 11xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====
x1= x1';
% Input 1
x1_step1.xoffset = [280;191;199;163;105;345;286;352;297;291;390;350;161;347;309;286];
x1_step1.gain = [0.0104166666666667;0.0151515151515152;0.0235294117647059;0.0151515151515152;0.0210526315789474;0.0131578947368421;0.0123456790123457;0.0194174757281553;0.0106951871657754;0.0111111111111111;0.0210526315789474;0.024390243902439;0.0188679245283019;0.021505376344086;0.0155038759689922;0.021505376344086];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.5675460868851516;1.5441130957439633;1.3052968439052421;-1.0496861716713037;0.86087036825259355;0.84589126116057523;0.64663539665361414;-0.24868468737847596;-0.29564751282486218;-0.098392316915376879;-0.22331570449961663;-0.42429820616066921;0.63814672684744844;-0.80759435046303352;0.58204846252331088;0.98648916544267962;1.159181647524659;-1.4796243134392026;1.4780555129382671;1.7352782121044379];
IW1_1 = [0.28446268373678107 -0.082959613950367064 -0.36481745955860745 -0.29674217484858767 0.35356552100772842 0.40715076561635249 0.10969032519552628 0.19075247342946355 0.49311895651441284 0.54376390274375985 -1.0152377889715811 0.085009331755126288 0.47978193026749105 -0.85676918754585707 -0.82840467067555523 0.16014427631206474;-0.64882165385915724 0.20983008293057615 -0.59680579128657496 -0.44175076262325341 0.26959804303666624 0.17235140057092876 0.20891111101679971 -0.48271273231292622 -0.39754212894724128 -0.14788422212868402 0.05017386120639579 0.21533495096185601 0.70330030226770979 -0.54099034186214146 -0.42516288205745073 0.37334437731126241;-0.25979010052723789 0.5448519013633697 -0.21851988676632972 0.55221787646238873 -0.65883592718298734 0.70209122299287596 0.45236256501442235 0.61479220394933587 0.043573659452450765 0.15034647271309809 -0.56819369064964231 0.47638422885078802 0.034238725122559995 -0.20090742057037037 -0.47850921591224888 -0.30566499458869845;0.29365663305809209 0.65026052216698027 -0.17796430946453068 0.59594600060001979 0.34439830647933517 0.64264290840106419 -0.58533656772316112 0.22155446082391539 -0.18931650784676579 0.37373529253774163 -0.67601450765661419 0.74074300955276506 -0.5087750852884253 -0.13604969432091588 0.029869490635268225 -0.52488446786050769;-0.77334969372525353 -0.52696975337092677 0.11571425870821554 0.99620800983116531 -0.093423431861599099 0.29653937973738137 0.24820157243625823 0.093965718999883235 -0.30065124907947011 0.64821685659760919 -0.31941905294453088 0.92253298578768927 0.27570258783711782 0.1685030461065905 0.074103194200327335 0.95549940231846531;-0.59216333164959667 -0.066435381167398097 0.42604739080950477 -0.3163751943131452 0.93646968113827223 -0.33122967972672568 0.45590373390270789 0.41379353997108137 -0.29145776091838133 -0.72023822495478507 -0.39204267417094507 -0.8886486143826462 -0.3255786256941568 0.19602510018131433 -0.21207098318804901 0.27579024839473948;-0.54468782482272604 -0.4699197417260158 0.14440652485867464 -0.92986880423697327 -0.7342091216371015 -0.23319969188905801 -0.31724704392114722 0.48557616517352697 -0.33055637145341638 0.23772269062493387 0.69807953602817896 -0.024557255213292249 -0.57348738790989484 0.97944213617139264 0.15885391949535471 0.38545937872975777;0.15984620630812502 0.68848319603366204 0.39310139734300276 -0.55371049765660407 -0.078163799347907181 0.15873631424960097 -0.28590726233349545 -0.032410640760243963 -0.69152132927502363 -0.37576732196436985 0.52877237147566547 0.62294427790669415 0.89678615060889888 -0.59775723642773071 0.43522334806234653 0.3259929786945181;0.68630613361639714 0.38665547210045731 0.51393417337732417 -0.42761699843493567 -0.40072479570478764 -0.57865179793589838 -0.84780045729828468 0.17075936765526925 -0.070210598929554849 0.5356747289383329 0.1507493452785208 -0.76056385381629699 -0.64605683916427614 -0.39045849341306382 -0.040767496086718154 -0.61493071731262927;0.12457012950558805 -0.79065067867339323 -0.59223502175489717 0.42739401891721507 0.17084819767310072 -0.39272247215789352 0.46064278122987068 0.22861638636657775 -0.53619379039903903 -0.36894541850117879 0.41212057362406829 0.51881590853955684 -0.28048457912308278 -1.1055935186645425 -0.7239056606009947 -0.2720458822269598;-0.62908900346136076 0.30132427769124814 0.10377218813959349 -0.3796387191760261 0.3112315554661822 0.21053303892142561 -0.090949389639709541 -0.40816296703811544 0.29617929869842835 0.55830143740504212 -0.84110153154779332 -0.55660310514696942 0.3931513381484314 0.6861107110981346 -0.063288156335461962 -0.34037707144153145;-0.55258859117451065 -0.3547664121490795 -0.075877045116611613 -0.018429863951560311 0.52854429051737939 -0.96403083538339251 0.3681281791077996 -0.72594905713588387 0.52328244201855845 -0.42361579869216309 0.2489345225586122 0.47128852407372568 -0.55522781643904628 -0.17406228385363112 -0.54722411634261625 0.3815249547786092;0.51224190215221443 -0.18131747800952353 -0.67575832240227751 -0.4534100983657357 0.56427544926220963 0.26393489026811023 -0.30400882870818058 0.56365564778073141 -0.88322956807366371 0.17889560688111833 0.38315118222185474 0.43897790984997737 0.26069441730945037 0.4335494633665562 -0.4689479332859679 -0.1593145981952796;-0.66589831943500244 0.046694045350888225 0.49912439082301291 -0.056951608682469214 0.38111581128845717 0.52986508450007019 0.5880899937526527 0.35929362361944861 0.787123222377342 0.81862285043966632 0.34976792953133395 -0.38652244036683742 0.13147130851852662 -0.23913851582195778 -0.287640012827516 -0.16669619759578039;0.042085029862308491 -0.80393218342730899 0.55863143366447676 -0.27022950090387821 -0.036797157983545388 0.34224643880530753 0.38093661525017664 0.030639049884855999 -0.69692978536830164 -0.40063690536669944 -0.074487181960834078 0.2260693591311469 -0.18105277126164659 0.83545275950323394 -0.66431696308001642 0.43699950893982886;0.60536264629248893 -0.23978219720360802 0.64130579332464943 -0.11441142588395481 0.56898399991638615 -0.23135016681590209 0.63991439277396434 -0.29324599133952367 -0.22435566229310713 -0.56443983039267842 0.53158388457422923 -0.068051553536189538 -0.099185083812727115 0.095191064156218183 -0.65456405402322737 0.36583483950126972;0.6053245703743797 0.64034221454830442 0.47600639011001827 -0.54313479349385996 -0.67742806073078332 -0.28207778790915083 -0.46584302479172113 0.22958680388901115 0.22225324880376721 0.087824620360075212 0.077622342247894147 0.496921977071136 0.55817013889005029 -0.071486267530103759 0.2813910680087251 0.26110978158469622;-0.57956915345966364 -0.49612649862815689 0.31530238243477676 -0.0039784772073813415 -0.27839592586987372 -0.66471793351357256 0.07107090227036815 -0.71557106839909701 -0.032473682686839409 0.18813804058579947 0.39151627200918077 0.19841039251829221 -0.44639390770941856 -0.75374613418158376 -0.084751842468840724 0.36237336652542451;0.50924027618487078 0.40784289562357645 0.27702453273780053 -0.66991274171665127 0.42675075432211873 -0.56982294616858509 -0.51718574895585101 -0.33502555176261206 0.45702901913913435 -0.54772691129611162 -0.29824769119499944 0.14081604750864651 0.14693759107781995 -0.54707346045252281 -0.63699917590911559 0.36083239357334135;0.63326701532471164 -0.21486604231860218 0.15104025364875029 0.47753845905261416 0.33261062951492559 0.27746511725580292 0.48883854970098528 -0.77606869164860448 -0.45468672336427485 0.38635443510611006 -0.62875637715775601 0.57298596099035404 0.15702503505148627 0.27746322684033703 -0.32049059202991748 -0.027934034352163243];

% Layer 2
b2 = [1.6200397386649341;-1.3405590999997954;-1.2240787816383532;1.1630309649521977;0.81352578949057885;0.58267495198533192;0.80059012460579315;0.37529093687923626;0.14207049131171737;-0.074186471359984435;0.052058273808437916;-0.26527874437664339;0.52526475006363582;-0.49203243006350683;0.6166240126967093;0.90679394194567975;1.1050919103138068;1.1931455603985075;-1.379377519824557;1.6130930892648048];
LW2_1 = [-0.57429436413443424 -0.021335729934634354 -0.33432010642845961 -0.36033398986308085 -0.65029210170782936 0.34586486980957665 -0.093410810666193153 0.39730611529027465 0.66447525314117573 -0.52931040839765753 -0.46924129821669497 -0.21688547584604606 -0.55982008289741969 -0.54793213790694761 0.044511221321716338 0.11906393769381721 -0.65301207048918586 0.39703837808422909 -0.18952159259148962 0.3997149725346501;0.30644096985185421 0.18848343103946399 -0.39965439621671039 -0.61676063649307133 -0.19763499590251313 -0.72736673830401077 -0.34686024326822001 -0.025767337133082827 0.49926674424974027 0.51644806049543845 -0.53376467522951421 0.37857453673937969 0.40061250447407787 -0.67052031479310159 -0.47030612721421133 0.265600487973082 0.08185666100644616 -0.46138650077601862 -0.20575696221924941 0.012383504610157393;0.058481698538809891 0.36867607053229345 -0.0083419354804371154 -0.52052065706133632 0.083664810935464004 0.36240010147025098 -0.26914068589128087 -0.40565778861995477 -0.90351420427622453 0.55050116239764391 0.049226020838184184 0.2555292876353612 -0.74297606727305732 0.60961483311079312 -0.61110787596782401 0.26957731173639154 0.19395470060001488 -0.13471979958200897 0.10137057460622885 0.50427965776824424;-0.41658625201129429 0.32805378649910261 0.1819594768519037 0.17501570863963894 0.28198579276054136 0.42196929782759818 0.45643504322609701 -0.31735762622700353 -0.49494246821285681 0.53591199626372676 -0.15922688356354123 0.2422635066307797 -0.17068112362113275 -0.32725097147419868 -0.18091220668344024 -0.20750634451596206 0.60887951187455425 0.46783162422847696 -0.0058891228612423041 0.50571487547813065;-0.4402466962106793 0.27068066330559498 0.40274976129444762 -0.41057868196867497 -0.89758724639915144 0.5785180527342475 0.64992686365817165 0.43380371559536635 -0.149817363272259 0.58963413258333264 -0.54488485759497429 0.51252861082227374 0.003087589945594289 -0.38669042751674693 -0.51540662544317373 0.079738159186299604 -0.55149408211956563 0.02054910318351014 0.16507976379449626 -0.57789656432593084;-0.39284374120702237 -0.25219130369649739 -0.58649561290597541 -0.36497270190484538 0.26453798976220844 -0.17632021655229035 0.36583957169577713 0.093185320769855223 0.10229171843867098 -0.38604232864271565 0.020149648004341547 0.36523229526645323 0.77781892135169151 -0.69406795922214215 0.66352074472407185 -0.38835951357974646 -0.29269980547052138 -0.45285044986714545 0.12023838460482784 -0.36306125388369787;-0.46918354070152257 -0.48316307354033566 -0.37237837078145281 -0.2132665250386486 0.16360914563005149 -0.012646375583103064 0.6167983919835015 -0.44274813596811374 0.16460487670541479 -0.061294675786717628 0.49219018600103581 0.91522487823957632 -0.054579795184804561 0.45905036737186677 0.37668491853723723 -0.02780012921935263 0.53083902002091155 0.80384893530108315 -0.1971968031477547 0.43304066166344962;-0.057912730577342079 -0.13963549960489083 -0.35276946374115914 -0.01410630315698551 0.87813234107886062 -0.5919723300551939 0.62514825051814082 0.76184262449595086 -0.069591151956348254 -0.68144773177463103 -0.34581071802848395 -0.24448889752867381 0.024663132168889351 -0.36808886843411248 -0.47233244976639549 0.080351702205118655 -0.26394201448248861 -0.028151927890848569 0.089750267954038468 -0.48104970977037748;-0.031823266784523893 -0.39437442640155523 0.26641786336982021 0.48484204709540574 -0.3650301872456041 0.5929187677274379 -0.10717108202567774 0.396133278077405 -0.2636640900818667 0.53287696846287391 -0.36392590499191013 0.089071418493575846 0.3850643579064415 0.6163553254089178 0.11652291304200808 -0.0029497540178258694 -0.7484603088209707 -0.23979862394323015 -0.13153315409933081 -0.13103836345371267;-0.10730469743093013 0.57671662869397466 -0.15502674485057893 0.12725252486572711 0.50943792035472024 0.27946748287089285 -0.56997458714144766 0.49008877679965901 -0.071504841788435719 -0.46592825970540042 0.11978126471379948 -0.63177530732429332 -0.32039854022734926 0.45298373831534194 0.57708961949830551 0.15034473188530215 -0.49770341316634148 -0.42479285083093199 0.13480114487140513 -0.45197947600063243;-0.31672430918365307 -0.34966010378400275 0.00032384306677107379 -0.69632168002341621 -0.80317787763934034 0.7563939260460425 0.83746354907941567 0.671029738745344 -0.85530762325871279 -0.70702883115155335 0.20996414765781604 0.2420692094243056 0.19544553858897581 0.25416926316761551 0.34585024635193901 0.22539039753275825 0.44864843149321426 -0.5184096615585092 0.48681086158639159 -0.11564085586500614;-0.58184870516588771 -0.13506937428330557 0.49537318758065396 -0.14434530602309459 0.52841675330106941 0.19717341782305686 0.30901071794253998 -0.26879342498227965 -0.30681435637583515 0.57171710547558907 -0.47975691452840247 -0.31025082874162796 0.16162889631007585 0.089189094305000924 0.61999644590280267 -0.72853415057614024 0.37741762472493745 -0.25449349487309325 0.26112163062479338 -0.66446144753508118;0.12749492981490743 0.33848877769602415 0.44821289879911319 0.43100279727094654 0.54873946139241025 0.45038759498957509 0.87483909160519635 0.051477425047268967 -0.20757999264677299 -0.3715570673003401 0.43882614534006714 -0.10047873088176211 0.48144739058267438 0.053498830980096924 0.46380128788213315 -0.52354875057388628 -0.25036259836113373 0.67991285971213633 0.20752187152051693 -0.052911112968019029;-0.45642928058149562 0.022756937532172748 0.62928350881103146 -0.3850947030269552 0.35625403280744744 0.0014217132891202345 -0.032491987157799315 0.43273842630837928 0.58306846934542711 0.14273324850508098 0.01463073739195866 -0.76061717444188137 0.5562186361231487 -0.41868474508104392 -0.48893706424362854 -0.28608487572442498 -0.071553293529761058 -0.45531520333163417 -0.42129441081073998 -0.38347631525742054;0.68482106015861233 -0.065557333686974348 -0.4611861894270739 0.60324964394580227 0.3910509038031374 -0.62203467199716289 0.085070430786656784 -0.44830037003930273 0.33892969361120567 -0.62364103011744743 -0.073312754837251221 0.52556828671830935 -0.37618035660929539 0.36209750373943228 0.281030940516724 -0.0037924724523154783 0.20592826141015391 0.47390957044472287 0.60958220600016588 0.37852669069949679;0.6962410754935795 0.60422739372826717 -0.037330968629568674 -0.19802364681670531 -0.30533175211777486 0.77532336433327853 0.38767163862713488 -0.71356712545304168 0.26236322273356127 -0.92150220308447717 0.3984522082445498 0.42052476194948607 -0.58378943311455822 -0.30125871105733348 -0.10440516702698832 -0.35660502034258518 -0.30545313693806431 0.32896354767071156 0.50373890228426288 0.32095290304228136;0.47537761248375232 -0.20848050938352031 0.30876578633460233 0.25836567928308818 -0.62923351006731176 0.39487672149340536 0.55239736010381102 0.50249272446402327 0.2338200671773229 -0.36696958231979093 0.077434555280294845 -0.024901489116760836 0.47883555584381865 0.032609612927355217 0.30406979183335309 -0.51508974499860793 -0.37745198368088084 0.15766070595766435 0.02210375440905268 -0.56561441839651505;0.38396602855771145 -0.67329490406699399 -0.31480410157088512 -0.45014352236192617 -0.30657721542541633 0.2139643128250632 -0.19654653431412031 0.20538426389855832 0.026406410276865726 0.62802808472206173 0.17331612902705437 -0.82225447942948482 -0.088871329034125909 0.68702445574877657 -0.47673015345343422 0.37575349731603641 0.50484291978855056 -0.1875105480810258 -0.26434315452104201 -0.30351735769831245;-0.13880870615077021 -0.40930894223961356 -0.71507746990380705 -0.057082030370615967 0.13195856438352027 0.39925919062051229 -0.39524408995587734 -0.63500092823545817 0.51585821384548147 -0.72986711617363276 -0.15182107777518977 -0.20184679258543509 0.33633766926270087 0.046650969612947346 -0.87467657484847072 0.31137386167764303 0.64610328641587855 -0.54292823912364241 0.23123694828945193 0.062214877996236692;0.55531494025651862 -0.25877288227600653 0.022452194174451077 0.40042637084502536 0.34322268257295385 0.69008090072935269 0.78932700176513126 0.19031900820996764 -0.95186804969120642 -0.19383120194694647 0.24042409035410606 -0.059034352526290468 -0.63594492399293212 0.021249041908422424 -0.40616681589029685 0.12164605193347128 -0.55176462764365442 -0.29654536728995651 -0.63235305200049263 -0.39092822759610013];

% Layer 3
b3 = [0.071456425440223029;-0.12988719459167353;0.88092198548122436;-0.57477215961008599;0.56366790946793399;0.79645999643012488;-0.13355558961697561;0.67030273194835133;0.44251222314391325;-0.53395592958586391;0.59915259304396118];
LW3_2 = [-0.85438337722075197 -0.45801842150873368 0.75632554733655666 -0.19692687820937621 -1.3650223093201226 -0.80770338282050813 -0.18371580180948913 -0.56070080729519833 -0.052832957242853841 -0.76837724475655822 -1.0348891849112012 0.065939815462259813 0.47373146626032059 -0.50477964290635502 0.37397948169732764 0.42803416360949353 0.096166208103344253 1.0627938406611626 -0.056887363667248531 0.6705349343684458;0.37042227978135506 -1.0811129629422473 1.2135433574628876 -0.78535854988032339 -0.65026546611778446 -0.36629253464743267 0.84805443281901227 -0.42902412725894057 -0.38129571191819356 0.37091971507247462 0.41677435028111393 -0.14897115899083846 -0.46795317427519784 0.53132097485119911 0.86937494699643236 0.60855834517886176 0.31831170881732229 -0.11188505246930733 1.0849244238562485 -0.6250518460244151;1.1300392013407634 -0.47961411177782015 0.44559705659155313 -0.6276462057118477 1.16979859312102 -1.3962366681397307 0.17625527405956712 0.71564321955061339 -0.63170844450897679 -0.45588367946377101 1.304678247617953 -0.45803816412578169 -0.72732737687101923 -1.0265827921774897 -0.11487236046194309 -0.51378324414179355 0.78912283162120656 0.11607332674970811 0.51974715648760994 0.31173276822922746;0.79820523850148861 0.59433958441332968 -0.63668446577539106 0.38468939422016896 0.0073407571228973978 0.37641947401869547 -0.97544997888298357 -1.3037673141124071 -0.060498394308778874 -0.24541750401960191 0.55531949537624081 0.70642803419208944 -0.30675057087724494 0.25156043532326822 -1.387942383677524 0.02586174594448289 0.059205000097756248 0.40713000064215432 -0.92136055380789605 -0.86960481544657309;0.13325494810775287 1.2594468245131771 -0.53871333933127419 0.72930374017135824 0.38815366318908429 1.2554391107752421 0.58239731764538671 0.35694823183106511 0.30087812040196604 -0.75134525476549519 0.57885154192310107 -0.23795278777080955 -0.21891647453022553 0.23743621416727734 0.4428470313038958 0.22760210253354304 0.45186204658241391 0.0882254670864248 0.80424354744951176 -0.30829427736651105;0.19460273580450241 0.29633722741051294 -1.34317030165503 -0.26104331413034454 0.91366883959650824 0.15614481105294439 -0.58337621392378569 -0.039627312622228572 -0.86393071151294065 -0.045831992481766747 0.81696407358514178 1.0452138166816896 0.92102287728796683 0.14450782812595594 -0.23892888721568845 -0.5856307200829256 0.80772354180750938 0.20917440815363872 0.0047818325695488289 0.57888369276500007;0.7363130319487452 0.37161860686763215 -0.24478209036938817 -0.14158857772882283 -0.06862011276271178 -0.04219028672757346 0.78289445524743961 0.92865741069797403 -0.99105255163841843 0.31909028873431333 -1.007130483914068 0.83960860393367465 0.81289129908575664 -0.57367798865996633 0.89348043686923151 1.1456089038507773 -0.4852803278192791 -0.62128911980689316 -1.2737227583772539 -0.1280359660715292;0.65178488421221736 0.44301589735287689 -0.29183320677688995 -0.29555891130250944 0.76418690490944563 0.84428305273041948 0.97021646771583969 -0.43745379639838011 -0.3547849550436738 -0.71693417385176039 1.2047842064801058 0.82714055152904886 0.63777141091961476 -0.26076235976586676 -0.079329571804360677 1.1239180535902467 0.39297484359810225 -0.70574078274922236 -0.097170495075033142 1.2302819996160859;-1.1121437486707699 1.012641828903903 0.035314203481733267 0.80775618478047273 -0.23153355032584394 -0.12015977282427183 0.32273986456599491 -0.48334061058017719 0.090166480375299216 -0.44895504449515666 -0.46385903841344367 1.0221078604418437 -0.87411099865698638 -0.26558658104567168 0.77118734387823673 -1.4394555723852667 -0.095004883673186283 -0.15040139443349629 -0.5093458961645041 -1.0656995013604869;0.34998673817664261 0.015327571366426521 0.9714663763640321 -0.23179897062993021 -0.26671049728631679 -0.45523896659037227 0.086357284032111806 0.59623277817188758 -0.66195556604449513 -1.0453278048541632 -1.0694807015510801 0.79037876480718605 0.13356211694345976 0.6161933014101959 -0.64339749419686043 -0.46922246257688194 -0.89844350683153085 0.46508638893142618 -0.99417626727475106 0.94641740014069375;-0.46887216693590328 0.46097866554602235 -0.46345904104503022 -0.23599452312189273 -1.0741638308268791 0.58249982091504282 -1.0127368263708469 0.31195538147217167 -0.85731635758464697 0.50048183439130434 -1.042394656635155 -0.72459324751326171 0.61769304835468586 1.1819208541930741 0.90180621778787939 -0.66714488851445397 0.0048916942858933301 0.038479559309391655 0.80209611948747839 -0.83695562344054875];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);

% Layer 3
a3 = softmax_apply(repmat(b3,1,Q) + LW3_2*a2);

% Output 1
y1 = a3;

%disp(y1)
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
  if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
  else
    a = iSoftmaxApplyCPU(n);
  end
end
function a = iSoftmaxApplyCPU(n)
  nmax = max(n,[],1);
  n = bsxfun(@minus,n,nmax);
  numerator = exp(n);
  denominator = sum(numerator,1); 
  denominator(denominator == 0) = 1;
  a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
  nmax = max(n,[],1);
  numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
  denominator = sum(numerator,1);
  a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
  numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
  if (denominator == 0)
    a = numerator;
  else
    a = numerator ./ denominator;
  end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
